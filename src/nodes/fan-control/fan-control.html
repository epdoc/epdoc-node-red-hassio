<script type="text/javascript">
  RED.nodes.registerType('fan-control',{
  category: 'function', //'home_assistant',
  color: '#a6bbcf',
  // color: NodeColor.HaBlue,
  inputs: 1,
  outputs: 2,
  outputLabels: ['done', 'call service'],
  icon: 'fan.svg',
  paletteLabel: 'Fan Control',
  label: function () {
    return this.name || `state_changed: ${this.entityId || 'all entities'}`;
  },
  labelStyle: 'node_label_italic',
  defaults: {
    name: { value: '' },
    fan: { value: '' },
    entityId: { value: '', required: true },
    instruction: { value: 'turn_on' },
    debugEnabled: { value: false },
    for: { value: '0' },
    forUnits: { value: 'minutes' }
  },
  oneditprepare: function() {
    console.log('oneditprepare')
  }
  });
</script>

<script type="text/x-red" data-template-name="fan-control">
  <input type="hidden" id="node-input-version" />
  <input type="hidden" id="node-input-outputs" />

  <div class="form-row">
    <label for="node-input-name"><i class="icon-tag"></i> Name</label>
    <input type="text" id="node-input-name" />
  </div>

  <div class="form-row">
    <label for="node-input-entityidfilter"><i class="icon-tag"></i> Fan</label>
    <select type="text" id="node-input-entity">
        <option
            value="exact"
            data-i18n="server-state-changed.label.entity_option.exact"
        ></option>
        <option
            value="list"
            data-i18n="server-state-changed.label.entity_option.list"
        ></option>
        <option
            value="regex"
            data-i18n="server-state-changed.label.entity_option.regex"
        ></option>
        <option
            value="substring"
            data-i18n="server-state-changed.label.entity_option.substring"
        ></option>
    </select>
  </div>

  <div class="form-row">
    <label
        for="node-input-instruction"
        data-i18n="server-state-changed.label.instruction"
    ></label>
    <select id="node-input-instruction" style="width: 20%">
      <option value="on">turn on, do not change speed</option>
      <option value="off">turn off</option>
      <option value="1">speed 1</option>
      <option value="2">speed 2</option>
      <option value="3">speed 3</option>
      <option value="4">speed 4</option>
      <option value="5">speed 5</option>
      <option value="6">speed 6</option>
    </select>
    <input type="text" id="node-input-instruction" style="width: 50%" />
    <input type="hidden" id="node-input-instruction" />
  </div>


  <div class="form-row">
    <label>For</label>&nbsp;
    <div class="ha-multi-item-row">
        <input type="text" id="node-input-for" />
        <select id="node-input-forUnits">
          <option value="milliseconds">Milliseconds</option>
          <option value="seconds">seconds</option>
          <option value="minutes">minutes</option>
          <option value="hours">hours</option>
          <option value="days">days</option>
        </select>
    </div>
  </div>

  <div class="form-row checkbox-option">
    <input type="checkbox" id="node-input-debug" />
    <label for="node-input-debug">Debug enabled</label>
  </div>
</script>

<script type="text/x-red" data-help-name="fan-control">
    <p>A node to control a fan that is configured with a separate smart switch and speed control.
        Because of this, the speed controller may not be able to receive messages unless the fan is on,
        and so we ensure a fan can receive speed change messages. 
        Also allows the fan to be turned on for a specified duration.
      </p>
    </script>
